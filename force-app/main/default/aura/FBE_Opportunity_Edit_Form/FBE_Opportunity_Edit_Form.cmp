<!--
*@ Class Name                           : FBE_Opportunity_Clone_With_OLI (Parent Component)
*@ Description                          : This is written for Clone Opportunity and Line Items and this Component invoked Click on Clone button.
*@ CreatedBy                            : Dell Team
*@ CreatedOn                            : 20-Feb-2020 [Sireesha Myla]
*@ Modification Log                     : 19-March-2020
     
*@Story No                              :12079751
      2.0                               :24-Feb-2022 [Varsha Singh];
Description                             :Behavior for Contract Name field on Opportunity Clone
-->

<aura:component controller="FBE_OpportunityEditForm_Ctrl" access="global" >
    <aura:attribute name="recordTypeId" type="String" />
    <aura:attribute name="recordId" type="String" />
    <aura:attribute name="sObjectName" type="String" />
    <aura:attribute name="sectionHeader" type="String"  />
    <aura:attribute name="sectionfieldSetName" type="String"  />
    <aura:attribute name="sectionFields" type="Object[]"  />
    <aura:attribute name="relatedProducts" type="OpportunityLineItem[]"  />
    
    <aura:handler name="init" value="{!this}" action="{!c.init}" />
    <aura:attribute name="showSpinner" type="Boolean" default="false" />
    
    <aura:attribute name="opportunity" type="Opportunity"/>
    <force:recordData aura:id="opportunityRecord"
                      recordId="{!v.recordId}"
                      targetFields="{!v.opportunity}"
                      layoutType="FULL"/>
    
    
    <aura:if isTrue="{!v.showSpinner}">
        <lightning:spinner />
    </aura:if>
    <lightning:notificationsLibrary aura:id="notifLib"/>
    <lightning:recordEditForm aura:id="testRecordEdit"
                              objectApiName="{!v.sObjectName }"
                              recordId="{!v.recordId }"
                              recordTypeId="{!v.recordTypeId }"
                              onload="{!c.handleOnload}"
                              onsubmit="{!c.onSubmitAction}">
        <!--<lightning:messages />-->
        <div style="background: white;" class="slds-scrollable">
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-title">
                    
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <lightning:icon iconName="action:new_opportunity" size="small" alternativeText="{!	v.sObjectName }"/>
                        </div>
                        <div class="slds-media__body">
                            <div class="slds-page-header__name" style="width:100%">
                                <div class="slds-page-header__name-title" style="width:100%">
                                    <h1>
                                        <span>Clone {!v.sObjectName }</span>
                                        <span class="slds-page-header__title" title="{!v.opportunity.Name}">{!v.opportunity.Name}</span>
                                    </h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div><br/>
            <aura:if isTrue="{!empty(v.relatedProducts)}">
                         <div style="padding:15px;">
						 <lightning:icon iconName="utility:info_alt" size="small" alternativeText="Line Items"/>
                           &nbsp;No Products attached for Cloning
                         </div>
            </aura:if>
            <center>
                <div class="slds-page-header__col-actions">
                    <lightning:button variant="brand" type="submit" label="Save" title="Save"  />
                    <lightning:button variant="neutral" type="button" label="Cancel" title="Cancel"  onclick="{!c.cancelAction}"/>
                </div>
            </center>
            <div class="slds-page-header_vertical"><br/>
                <!-- OPPORTUNITY CLONE FIELDS -->
                <h3 class="slds-section-title--divider" style="color:rgba(60, 74, 164, 1.0);font-weight:bold;">{!v.sectionHeader}</h3>
                <lightning:layout multipleRows="true">
                    <!--<lightning:layoutItem size="12" smallDeviceSize="6" mediumDeviceSize="6" largeDeviceSize="6" class="slds-hide">
                            <div class="custom-box" >
                               <lightning:inputField aura:id="SiebelOppId" fieldName="FBE_Siebel_Opportunity_Id__c" class="slds-p-top_small slds-m-top_medium"/>
                            </div>
                            
                         </lightning:layoutItem>-->
                                
                        
                     <aura:iteration items="{!v.sectionFields}" var="field" >
                                
                            <lightning:layoutItem size="12" smallDeviceSize="6" mediumDeviceSize="6" largeDeviceSize="6" >
                                <!--<div class="slds-grid">-->
                               
								<lightning:inputField fieldName="{!field }" class="slds-p-top_small slds-m-top_medium" aura:id = "makeblank" required="false" />
                               
                               <!--</div>-->
                            </lightning:layoutItem>
                     </aura:iteration>
                    
                </lightning:layout>
                <br/>
                <!-- OPPORTUNITY PRODUCT DETAILS -->
                
                <div>
                  <!--<aura:if isTrue="{!not(empty(v.relatedProducts))}">-->
                    <h3 class="slds-section-title--divider" style="color:rgba(60, 74, 164, 1.0);font-weight:bold;">
                        <lightning:icon iconName="standard:product_item" size="small" alternativeText="Line Items"/>
                        Product List
                    </h3>
					<aura:if isTrue="{!empty(v.relatedProducts)}">
                         <div style="padding:15px;">
						 <lightning:icon iconName="utility:info_alt" size="small" alternativeText="Line Items"/>
                           &nbsp;No Products attached for Cloning
                         </div>
				<!--</aura:if>-->
				    <aura:set attribute="else">
                    <table class="slds-table slds-table_cell-buffer slds-table_bordered" >
					
                        <thead>
                            <tr class="slds-line-height_reset">
                                <th class="slds-text-title_caps" scope="col">
                                    <div class="slds-truncate" ></div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                    <div class="slds-truncate" title="PRODUCT">PRODUCT</div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                    <div class="slds-truncate" title="QUANTITY">QUANTITY</div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                    <div class="slds-truncate" title="SALES PRICE">SALES PRICE</div>
                                </th>
                               <!-- <th class="slds-text-title_caps" scope="col" >
                                    <div class="slds-truncate" title="SIEBEL REV ID">SIEBEL REV ID</div>
                                </th>-->
                                <th class="slds-text-title_caps" scope="col">
                                    <div class="slds-truncate" title="QUOTE #">QUOTE #</div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                    <div class="slds-truncate" title="LINE DESCRIPTION">LINE DESCRIPTION</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <aura:iteration items="{!v.relatedProducts}" var="product" indexVar="count">
                                <tr class="slds-hint-parent">
                                    <td >
                                        <div class="slds-truncate" title="Remove">
                                            
                                            <a style="text-decoration:none;color:red;" data-row="{!count}" onclick="{!c.removeOLI}">
                                            <lightning:icon size="x-small" iconName="action:delete" alternativeText="Delete" title="Delete" />
                                            </a>
                                        </div>
                                    </td>
                                    <td >
                                        <div class="slds-truncate" title="{!product.Product2.Name}">
                                            {!product.Product2.Name}
                                        </div>
                                    </td>
                                    <td >
                                        <div class="slds-truncate" title="{!product.Quantity}">
                                            <lightning:input type="number" name="input1" value="{!product.Quantity}" />
                                        </div>
                                    </td>
                                    <td >
                                        <div class="slds-truncate" title="{!product.UnitPrice}">
                                            <lightning:input type="number" name="input2" value="{!product.UnitPrice}" />
                                        </div>
                                    </td>
                                    
                                     <!--<td  >
                                        <div class="slds-truncate" title="{!product.FBE_Siebel_Revenue_Id__c}">
                                            <lightning:input type="text" name="input4" value="{!product.FBE_Siebel_Revenue_Id__c}" />
                                        </div>
                                    </td>-->
                                    <td >
                                        <div class="slds-truncate" title="{!product.FBE_Quote_Number_Line__c}">
                                            <lightning:input type="text" name="input5" value="{!product.FBE_Quote_Number_Line__c}" />
                                        </div>
                                    </td>
                                    
                                    <td>
                                        <div class="slds-truncate" title="{!product.Description}">
                                            <lightning:input type="text" name="input6" value="{!product.Description}" />
                                        </div>
                                    </td>
                                </tr>
                            </aura:iteration>
                        </tbody>
                    </table>
					</aura:set>
                   </aura:if>
                </div> 
               
            </div>
            <center>
                <div class="slds-page-header__col-actions">
                    <lightning:button variant="brand" type="submit" label="Save" title="Save"  />
                    <lightning:button variant="neutral" type="button" label="Cancel" title="Cancel"  onclick="{!c.cancelAction}"/>
                </div>
            </center>
        </div>
    </lightning:recordEditForm>    
</aura:component>